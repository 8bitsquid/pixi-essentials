/*!
 * @pixi-essentials/conic - v1.0.0
 * Compiled Tue, 14 Jul 2020 17:57:17 UTC
 *
 * @pixi-essentials/conic is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_essentials_conic=function(t,n,r,e,i,o){"use strict";var a=new n.AttributeRedirect({source:"worldPositionData",attrib:"aWorldPosition",type:"float32",size:2,glType:r.TYPES.FLOAT,glSize:2}),s=new n.AttributeRedirect({source:"texturePositionData",attrib:"aTexturePosition",type:"float32",size:2,glType:r.TYPES.FLOAT,glSize:2}),c=new n.UniformRedirect({source:"k",uniform:"k"}),u=new n.UniformRedirect({source:"l",uniform:"l"}),f=new n.UniformRedirect({source:"m",uniform:"m"}),l=new n.BatchShaderFactory("#version 300 es\n\n#define SHADER_NAME Conic-Renderer-Shader\n\nprecision mediump float;\n\nin vec2 aWorldPosition;\nin vec2 aTexturePosition;\nin float aMasterID;\nin float aUniformID;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vWorldCoord;\nout vec2 vTextureCoord;\nout float vMasterID;\nout float vUniformID;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aWorldPosition, 1)).xy, 0, 1);\n\n    vWorldCoord = gl_Position.xy;\n    vTextureCoord = aTexturePosition;\n    vMasterID = aMasterID;\n    vUniformID = aUniformID;\n}","#version 300 es\n#define SHADER_NAME Conic-Renderer-Shader\n\nprecision mediump float;\n\nuniform sampler2D uSamplers[%texturesPerBatch%];\n\nin vec2 vWorldCoord;\nin vec2 vTextureCoord;\nin float vMasterID;\nin float vUniformID;\n\nout vec4 fragmentColor;\n\nuniform vec3 k[%uniformsPerBatch%];\nuniform vec3 l[%uniformsPerBatch%];\nuniform vec3 m[%uniformsPerBatch%];\nuniform bool inside;\n\nvoid main(void)\n{\n    vec3 kv, lv, mv;\n\n    for (int i = 0; i < %uniformsPerBatch%; i++)\n    {\n        if (float(i) > vUniformID - 0.5) \n        {\n            kv = k[i];\n            lv = l[i];\n            mv = m[i];\n            break;\n        }\n    }\n\n    float k_ = dot(vec3(vTextureCoord, 1), kv);\n    float l_ = dot(vec3(vTextureCoord, 1), lv);\n    float m_ = dot(vec3(vTextureCoord, 1), mv);\n\n    float cv = k_ * k_ - l_ * m_;\n\n    float cvdx = dFdx(cv);\n    float cvdy = dFdy(cv);\n    vec2 gradientTangent = vec2(cvdx, cvdy);\n\n    float signedDistance = cv / length(gradientTangent);\n    bool antialias = signedDistance > -1. && signedDistance < 1.;\n\n    vec4 color;\n\n    if ((inside && cv < 0.) || (!inside && cv >= 0.) || antialias)\n    {\n        for (int i = 0; i < %texturesPerBatch%; i++)\n        {\n            if (float(i) > vMasterID - 0.5)\n            {\n                color = texture(uSamplers[i], vTextureCoord);\n                break;\n            }\n        }\n    }\n    else\n    {\n        color = vec4(0, 0, 0, 1);\n    }\n\n    if (antialias)\n    {\n        float weight = inside ? (1. - signedDistance) / 2. : (1. + signedDistance) / 2.;\n        \n        color = weight * color + (1. - weight) * vec4(0, 0, 0, 1);\n    }\n\n    fragmentColor = color;\n}",{}).derive(),d=n.BatchRendererPluginFactory.from({attribSet:[a,s],uniformSet:[c,u,f],indexProperty:"indexData",textureProperty:"_texture",texIDAttrib:"aMasterID",uniformIDAttrib:"aUniformID",inBatchIDAttrib:"aBatchID",shaderFunction:function(t){var n=t.renderer,r=n.context;return 1!==r.webGLVersion||r.extensions.standardDerivatives||(r.extensions.standardDerivatives=n.gl.getExtension("OES_standard_derivatives")),l(t)},BatchFactoryClass:n.AggregateUniformsBatchFactory});e.Renderer.registerPlugin("conicRenderer",d);var v=d;var h={adjoint:function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],c=n[6],u=n[7],f=n[8];return t[0]=a*f-s*u,t[1]=i*u-e*f,t[2]=e*s-i*a,t[3]=s*c-o*f,t[4]=r*f-i*c,t[5]=i*o-r*s,t[6]=o*u-a*c,t[7]=e*c-r*u,t[8]=r*a-e*o,t},clone:function(t){var n=new Float32Array(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},create:function(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},determinant:function(t){var n=t[0],r=t[1],e=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],u=t[8];return n*(u*o-a*c)+r*(a*s-u*i)+e*(c*i-o*s)},frob:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8])},fromMat2:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},fromMat4:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},fromQuat:function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r+r,s=e+e,c=i+i,u=r*a,f=e*a,l=e*s,d=i*a,v=i*s,h=i*c,m=o*a,p=o*s,y=o*c;return t[0]=1-l-h,t[3]=f-y,t[6]=d+p,t[1]=f+y,t[4]=1-u-h,t[7]=v-m,t[2]=d-p,t[5]=v+m,t[8]=1-u-l,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},invert:function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],c=n[6],u=n[7],f=n[8],l=f*a-s*u,d=-f*o+s*c,v=u*o-a*c,h=r*l+e*d+i*v;return h?(h=1/h,t[0]=l*h,t[1]=(-f*e+i*u)*h,t[2]=(s*e-i*a)*h,t[3]=d*h,t[4]=(f*r-i*c)*h,t[5]=(-s*r+i*o)*h,t[6]=v*h,t[7]=(-u*r+e*c)*h,t[8]=(a*r-e*o)*h,t):null},multiply:function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],f=n[7],l=n[8],d=r[0],v=r[1],h=r[2],m=r[3],p=r[4],y=r[5],x=r[6],g=r[7],D=r[8];return t[0]=d*e+v*a+h*u,t[1]=d*i+v*s+h*f,t[2]=d*o+v*c+h*l,t[3]=m*e+p*a+y*u,t[4]=m*i+p*s+y*f,t[5]=m*o+p*c+y*l,t[6]=x*e+g*a+D*u,t[7]=x*i+g*s+D*f,t[8]=x*o+g*c+D*l,t},normalFromMat4:function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],c=n[6],u=n[7],f=n[8],l=n[9],d=n[10],v=n[11],h=n[12],m=n[13],p=n[14],y=n[15],x=r*s-e*a,g=r*c-i*a,D=r*u-o*a,_=e*c-i*s,I=e*u-o*s,P=i*u-o*c,T=f*m-l*h,b=f*p-d*h,w=f*y-v*h,M=l*p-d*m,k=l*y-v*m,C=d*y-v*p,R=x*C-g*k+D*M+_*w-I*b+P*T;return R?(R=1/R,t[0]=(s*C-c*k+u*M)*R,t[1]=(c*w-a*C-u*b)*R,t[2]=(a*k-s*w+u*T)*R,t[3]=(i*k-e*C-o*M)*R,t[4]=(r*C-i*w+o*b)*R,t[5]=(e*w-r*k-o*T)*R,t[6]=(m*P-p*I+y*_)*R,t[7]=(p*D-h*P-y*g)*R,t[8]=(h*I-m*D+y*x)*R,t):null},rotate:function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],f=n[7],l=n[8],d=Math.sin(r),v=Math.cos(r);return t[0]=v*e+d*a,t[1]=v*i+d*s,t[2]=v*o+d*c,t[3]=v*a-d*e,t[4]=v*s-d*i,t[5]=v*c-d*o,t[6]=u,t[7]=f,t[8]=l,t},scale:function(t,n,r){var e=r[0],i=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},translate:function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],f=n[7],l=n[8],d=r[0],v=r[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=c,t[6]=d*e+v*a+u,t[7]=d*i+v*s+f,t[8]=d*o+v*c+l,t},transpose:function(t,n){if(t===n){var r=n[1],e=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}},m=(h.adjoint,h.clone,h.copy,h.create,h.determinant,h.frob,h.fromMat2,h.fromMat4,h.fromQuat,h.identity,h.invert,h.multiply,h.normalFromMat4,h.rotate,h.scale,h.str,h.translate,h.transpose,function(){function t(){this.k=[0,1,-1],this.l=[2,-1,-1],this.m=[-2,-1,-1],this.textureTransform=new i.Matrix,this._dirtyID=0}return t.prototype.setk=function(t,n,r){return this.k[0]=t,this.k[1]=n,this.k[2]=r,this._dirtyID++,this},t.prototype.setl=function(t,n,r){return this.l[0]=t,this.l[1]=n,this.l[2]=r,this._dirtyID++,this},t.prototype.setm=function(t,n,r){return this.m[0]=t,this.m[1]=n,this.m[2]=r,this._dirtyID++,this},t.prototype.setTransform=function(){for(var t,n,r,e,i,o,a,s,c,u,f,l,d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];if(1===d.length)return this.textureTransform.copyFrom(d[0]),this;if(this.textureTransform.identity(),6===d.length){var m=d;t=m[0].x,n=m[0].y,r=m[1].x,e=m[1].y,i=m[2].x,o=m[2].y,a=m[3].x,s=m[3].y,c=m[4].x,u=m[4].y,f=m[5].x,l=m[5].y}else{var p=d;t=p[0],n=p[1],r=p[2],e=p[3],i=p[4],o=p[5],a=p[6],s=p[7],c=p[8],u=p[9],f=p[10],l=p[11]}var y=[t,r,i,n,e,o,1,1,1],x=h.invert(y,y);return this.textureTransform.a=x[0]*a+x[3]*c+x[6]*f,this.textureTransform.c=x[1]*a+x[4]*c+x[7]*f,this.textureTransform.tx=x[2]*a+x[5]*c+x[8]*f,this.textureTransform.b=x[0]*s+x[3]*u+x[6]*l,this.textureTransform.d=x[1]*s+x[4]*u+x[7]*l,this.textureTransform.ty=x[2]*s+x[5]*u+x[8]*l,this},t.prototype.update=function(){return this._dirtyID++,this},t}()),p=function(t,n){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)};var y=new i.Matrix,x=function(t){function n(n){void 0===n&&(n=new m);var r=t.call(this)||this;return r.shape=n,r._dirtyID=0,r._transformID=0,r._updateID=-1,r.worldPositionData=[],r.texturePositionData=[],r._texture=e.Texture.WHITE,r}return function(t,n){function r(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,t),Object.defineProperty(n.prototype,"k",{get:function(){return this.shape.k},set:function(t){var n;(n=this.shape).setk.apply(n,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"l",{get:function(){return this.shape.l},set:function(t){var n;(n=this.shape).setl.apply(n,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"m",{get:function(){return this.shape.m},set:function(t){var n;(n=this.shape).setm.apply(n,t)},enumerable:!0,configurable:!0}),n.prototype._render=function(t){t.plugins.conicRenderer||(t.plugins.conicRenderer=new v(t,null)),t.batch.setObjectRenderer(t.plugins.conicRenderer),t.plugins.conicRenderer.render(this)},n.prototype.drawTriangle=function(t,n,r,e,i,o){var a=this.texturePositionData,s=a.length;a.length+=6,a[s]=t,a[s+1]=n,a[s+2]=r,a[s+3]=e,a[s+4]=i,a[s+5]=o},n.prototype.drawRect=function(t,n,r,e){var i=this.texturePositionData,o=i.length;i.length+=12,i[o]=t,i[o+1]=n,i[o+2]=t+r,i[o+3]=n,i[o+4]=t+r,i[o+5]=n+e,i[o+6]=t,i[o+7]=n,i[o+8]=t+r,i[o+9]=n+e,i[o+10]=t,i[o+11]=n+e},n.prototype.updateConic=function(){var t=this.worldPositionData,n=this.texturePositionData;t.length=n.length;for(var r=y.copyFrom(this.shape.textureTransform).prepend(this.worldTransform),e=r.a,i=r.b,o=r.c,a=r.d,s=r.tx,c=r.ty,u=0,f=t.length/2;u<f;u++){var l=n[2*u],d=n[2*u+1];t[2*u]=e*l+o*d+s,t[2*u+1]=i*l+a*d+c}this._updateID=this._dirtyID;var v=this.indexData=new Array(t.length/2);for(u=0,f=v.length;u<f;u++)v[u]=u},n.prototype.updateTransform=function(){var n=t.prototype.updateTransform.call(this);return this._transformID!==this.transform._worldID&&(this.updateConic(),this._transformID=this.transform._worldID),n},n}(o.Container);return t.Conic=m,t.ConicGraphic=x,t}({},pixiBatchRenderer,constants,core,math,display);Object.assign(this.PIXI,_pixi_essentials_conic);
//# sourceMappingURL=conic.js.map
